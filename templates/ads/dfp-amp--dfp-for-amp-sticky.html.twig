{{ attach_library('infinite_amp/amp.sticky') }}

{% if rtc_config %}
  {% set vendors = rtc_config.vendors %}
  {% set rtc_config = rtc_config|merge({vendors: vendors}) %}
  {% set rtc_config_value = rtc_config|json_encode(constant('JSON_HEX_TAG') b-or constant('JSON_HEX_APOS') b-or constant('JSON_HEX_QUOT') b-or constant('JSON_UNESCAPED_UNICODE')) %}
{% endif %}

<amp-sticky-ad layout="nodisplay" data-block-on-consent="_till_accepted">
  <amp-ad{{ attributes }}
    json='{{ json|json_encode(constant('JSON_HEX_TAG') b-or constant('JSON_HEX_APOS') b-or constant('JSON_HEX_QUOT') b-or constant('JSON_UNESCAPED_UNICODE'))|raw }}'
    {% if rtc_config %}
      rtc-config='{{ rtc_config_value|raw }}'
    {% endif %}
  >
  </amp-ad>
</amp-sticky-ad>
